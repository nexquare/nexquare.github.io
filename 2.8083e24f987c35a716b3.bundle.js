(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{1407:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return course_manager_CourseManager}));var tslib_es6=__webpack_require__(1),core=__webpack_require__(0),distinctUntilChanged=__webpack_require__(79),take=__webpack_require__(85),filter=__webpack_require__(44),tap=__webpack_require__(73),datorama_akita=__webpack_require__(244);let courses_store_CoursesStore=class CoursesStore extends datorama_akita.a{constructor(){super({loaded:!1,loading:!1,adding:!1,deleting:!1,updating:!1,query:"",fileUploading:!1,courseDeliveryMethodsOptions:null,courseTypesOptions:null,courseSkillsOptions:null,courseLearningLevelsOptions:null,courseInstructorTypesOptions:null,courseSubjectsOptions:null,courseInstructionLanguageOptions:null,courseEnrollmentMethodsOptions:null,coursePaymentMethodsOptions:null,competenciesOptions:null,courseChannelRequirementsOptions:null,courseAccessLifetimeOptions:null,courseSubscriptionTypesOptions:null,courseAccessTypesOptions:null,courseGradeBookDisplaySettingsOptions:null,courseStatusOptions:null,currencyOptions:null,courseCreateSteps:["settings","course-content","completion-settings","roles","preview"],currentStep:"",currentCourseId:0,fullyLoaded:[]})}};var _a;courses_store_CoursesStore=Object(tslib_es6.c)([Object(core.Injectable)({providedIn:"root"}),Object(datorama_akita.c)({name:"courses"}),Object(tslib_es6.f)("design:paramtypes",[])],courses_store_CoursesStore);let courses_query_CoursesQuery=class CoursesQuery extends datorama_akita.b{constructor(store){super(store),this.store=store}selectCourses(){return this.selectAll()}selectCourseById(id){return this.selectEntity(id)}};courses_query_CoursesQuery=Object(tslib_es6.c)([Object(core.Injectable)({providedIn:"root"}),Object(tslib_es6.f)("design:paramtypes",["function"==typeof(_a=void 0!==courses_store_CoursesStore&&courses_store_CoursesStore)?_a:Object])],courses_query_CoursesQuery);var course_manager_a,_b,_c,_d,courses_service=__webpack_require__(1412),dropdown_options_service=__webpack_require__(1408);let course_manager_CourseManager=class CourseManager{constructor(coursesStore,coursesQuery,coursesService,dropdownOptionsService){this.coursesStore=coursesStore,this.coursesQuery=coursesQuery,this.coursesService=coursesService,this.dropdownOptionsService=dropdownOptionsService}getLoading(){return this.coursesQuery.selectLoading()}getLoaded(){return this.coursesQuery.select("loaded")}setLoading(value){this.coursesStore.setLoading(value)}getAdding(){return this.coursesQuery.select("adding")}getDeleting(){return this.coursesQuery.select("deleting")}getUpdating(){return this.coursesQuery.select("updating")}setAdding(value){this.coursesStore.update({adding:value})}setUpdating(value){this.coursesStore.update({updating:value})}setDeleting(value){this.coursesStore.update({deleting:value})}getQuery(){return this.coursesQuery.select("query")}setQuery(value){this.coursesStore.update({query:value})}getFileUploading(){return this.coursesQuery.select("fileUploading")}setFileUploading(value){this.coursesStore.update({fileUploading:value})}getCourses(force=!1){this.combinedSubscription&&this.combinedSubscription.unsubscribe();const query$=this.getQuery().pipe(Object(distinctUntilChanged.a)());return this.combinedSubscription=query$.subscribe(()=>{this.searchSubscription&&(this.setLoading(!1),this.searchSubscription.unsubscribe()),this.fetchCourses(!0)}),this.coursesQuery.selectCourses()}fetchCourses(force=!1){let loading=!1,loaded=!1,query="";if(this.getLoading().pipe(Object(take.a)(1)).subscribe(res=>loading=res),this.getLoaded().pipe(Object(take.a)(1)).subscribe(res=>loaded=res),this.getQuery().pipe(Object(take.a)(1)).subscribe(res=>query=res),!loading&&(!loaded||force)){this.setLoading(!0),this.searchSubscription=this.coursesService.getCourseList().subscribe(res=>{const mappedCourses=res.courses.map(v=>Object.assign(Object.assign({},v),{id:v.courseId}));this.coursesStore.upsertMany(mappedCourses),this.coursesStore.update({loaded:!0}),this.setLoading(!1)},err=>{this.setLoading(!1)})}}getCourseById(id){let loaded=!1,loading=!1;return this.getFullyLoaded().pipe(Object(take.a)(1)).subscribe(res=>loaded=res.includes(id)),this.getLoading().pipe(Object(take.a)(1)).subscribe(res=>loading=res),console.log("LOADING LOADED",loading,loaded),loaded||loading||this.fetchCourseById(id),this.coursesQuery.selectEntity(id).pipe(Object(filter.a)(v=>(this.getFullyLoaded().pipe(Object(take.a)(1)).subscribe(res=>{loaded=res.includes(id)}),!!v&&loaded)))}fetchCourseById(id){let loading=!1;this.getLoading().subscribe(l=>loading=l),loading||(this.setLoading(!0),this.coursesService.getCourse(id).subscribe(res=>{this.setFullyLoaded(id),this.setLoading(!1),this.coursesStore.upsert(id,res.learningContent)},err=>{this.setLoading(!1)}))}updateCourse(id,data){this.setUpdating(!0);const dataForApi=this.deleteNullFields(data);return console.log(dataForApi),this.coursesService.updateCourse(id,dataForApi).pipe(Object(tap.a)(res=>{this.setFullyLoaded(id),this.setUpdating(!1),this.coursesStore.update(id,res)},err=>{this.setUpdating(!1)}))}duplicateCourse(id){return this.setUpdating(!0),this.coursesService.duplicateCourse(id).pipe(Object(tap.a)(res=>{this.setFullyLoaded(res.id),this.setUpdating(!1),this.coursesStore.add(res)},err=>{this.setUpdating(!1)}))}deleteCourse(id){this.setDeleting(!0)}createCourse(data){this.setAdding(!0);const dataForApi=this.deleteNullFields(data);return console.log(data,dataForApi),this.coursesService.createCourse(dataForApi).pipe(Object(tap.a)(res=>{this.setFullyLoaded(res.id),this.setAdding(!1),this.coursesStore.add(res)},err=>this.setAdding(!1)))}deleteNullFields(data){return Object.keys(data).map(key=>{data[key]&&0!==data[key].length||"boolean"!=typeof data[key]&&delete data[key]}),data}updateCourseStatus(id,status){return this.setUpdating(!0),this.coursesService.updateCourseStatus(id,status).pipe(Object(tap.a)(res=>{this.coursesStore.update(id,{status:status}),this.setUpdating(!1)},err=>this.setUpdating(!1)))}courseIsShortCodeUnique(shortCode){return this.coursesService.courseIsShortCodeUnique(shortCode)}getCourseCreateCurrentStep(){return this.coursesQuery.select("currentStep")}setCourseCreateCurrentStep(step){this.coursesStore.update({currentStep:step})}getCourseCreateSteps(){return this.coursesQuery.select("courseCreateSteps")}setCourseCreateSteps(type,deliverOutside,gradebookNeeded){console.log("SET STEPS",type,deliverOutside,gradebookNeeded);let steps=["settings","course-content","personalise","roles","preview"];"Course"===type||"Assessment"===type?(steps.splice(2,0,"completion-settings"),gradebookNeeded&&steps.splice(3,0,"gradebook")):"Pathway"===type?steps.splice(2,0,"completion-settings"):"Pulse"!==type&&"Feedback"!==type||steps.splice(2,0,"template-settings"),deliverOutside&&(steps=["settings","preview"]),setTimeout(()=>{this.coursesStore.update({courseCreateSteps:steps})})}getCurrentCourseId(){return this.coursesQuery.select("currentCourseId")}setCurrentCourseId(value){this.coursesStore.update({currentCourseId:value})}getFullyLoaded(){return this.coursesQuery.select("fullyLoaded")}setFullyLoaded(value){this.coursesStore.update(state=>Object.assign(Object.assign({},state),{fullyLoaded:[...state.fullyLoaded,value]}))}getCourseDeliveryMethodsOptions(){return this.coursesQuery.select("courseDeliveryMethodsOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseDeliveryMethods().subscribe(value=>{this.setCourseDeliveryMethodsOptions(value)})}))}setCourseDeliveryMethodsOptions(value){this.coursesStore.update({courseDeliveryMethodsOptions:value})}getCourseTypesOptions(){return this.coursesQuery.select("courseTypesOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseTypes().subscribe(value=>{this.setCourseTypesOptions(value)})}))}setCourseTypesOptions(value){this.coursesStore.update({courseTypesOptions:value})}getCourseSkillsOptions(){return this.coursesQuery.select("courseSkillsOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseSkills().subscribe(value=>{this.setCourseSkillsOptions(value)})}))}setCourseSkillsOptions(value){this.coursesStore.update({courseSkillsOptions:value})}getCourseLearningLevelsOptions(){return this.coursesQuery.select("courseLearningLevelsOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseLearningLevels().subscribe(value=>{this.setCourseLearningLevelsOptions(value)})}))}setCourseLearningLevelsOptions(value){this.coursesStore.update({courseLearningLevelsOptions:value})}getCourseInstructorTypesOptions(){return this.coursesQuery.select("courseInstructorTypesOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseInstructorTypes().subscribe(value=>{this.setCourseInstructorTypesOptions(value)})}))}setCourseInstructorTypesOptions(value){this.coursesStore.update({courseInstructorTypesOptions:value})}getCourseSubjectsOptions(){return this.coursesQuery.select("courseSubjectsOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseSubjects().subscribe(value=>{this.setCourseSubjectsOptions(value)})}))}setCourseSubjectsOptions(value){this.coursesStore.update({courseSubjectsOptions:value})}getCourseInstructionLanguageOptions(){return this.coursesQuery.select("courseInstructionLanguageOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseInstructionLanguage().subscribe(value=>{this.setCourseInstructionLanguageOptions(value)})}))}setCourseInstructionLanguageOptions(value){this.coursesStore.update({courseInstructionLanguageOptions:value})}getCourseEnrollmentMethodsOptions(){return this.coursesQuery.select("courseEnrollmentMethodsOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseEnrollmentMethods().subscribe(value=>{this.setCourseEnrollmentMethodsOptions(value)})}))}setCourseEnrollmentMethodsOptions(value){this.coursesStore.update({courseEnrollmentMethodsOptions:value})}getCoursePaymentMethodsOptions(){return this.coursesQuery.select("coursePaymentMethodsOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.coursePaymentMethods().subscribe(value=>{this.setCoursePaymentMethodsOptions(value)})}))}setCoursePaymentMethodsOptions(value){this.coursesStore.update({coursePaymentMethodsOptions:value})}getCompetenciesOptions(){return this.coursesQuery.select("competenciesOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseCompetencies().subscribe(value=>{this.setCompetenciesOptions(value)})}))}setCompetenciesOptions(value){this.coursesStore.update({competenciesOptions:value})}getCourseChannelRequirementsOptions(){return this.coursesQuery.select("courseChannelRequirementsOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseChannelRequirements().subscribe(value=>{this.setCourseChannelRequirementsOptions(value)})}))}setCourseChannelRequirementsOptions(value){this.coursesStore.update({courseChannelRequirementsOptions:value})}getCourseAccessLifetimeOptions(){return this.coursesQuery.select("courseAccessLifetimeOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseAccessLifetime().subscribe(value=>{this.setCourseAccessLifetimeOptions(value)})}))}setCourseAccessLifetimeOptions(value){this.coursesStore.update({courseAccessLifetimeOptions:value})}getCourseSubscriptionTypesOptions(){return this.coursesQuery.select("courseSubscriptionTypesOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseSubscriptionTypes().subscribe(value=>{this.setCourseSubscriptionTypesOptions(value)})}))}setCourseSubscriptionTypesOptions(value){this.coursesStore.update({courseSubscriptionTypesOptions:value})}getCourseAccessTypesOptions(){return this.coursesQuery.select("courseAccessTypesOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseAccessTypes().subscribe(value=>{this.setCourseAccessTypesOptions(value)})}))}setCourseAccessTypesOptions(value){this.coursesStore.update({courseAccessTypesOptions:value})}getCourseGradeBookDisplaySettingsOptions(){return this.coursesQuery.select("courseGradeBookDisplaySettingsOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseGradeBookDisplaySettings().subscribe(value=>{this.setCourseGradeBookDisplaySettingsOptions(value)})}))}setCourseGradeBookDisplaySettingsOptions(value){this.coursesStore.update({courseGradeBookDisplaySettingsOptions:value})}getCurrencyOptions(){return this.coursesQuery.select("currencyOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.currencies().subscribe(value=>{this.setCurrencyOptions(value)})}))}setCurrencyOptions(value){this.coursesStore.update({currencyOptions:value})}getCourseStatusOptions(){return this.coursesQuery.select("statusOptions").pipe(Object(tap.a)(res=>{res||this.dropdownOptionsService.courseStatus().subscribe(value=>{this.setCourseStatusOptions(value)})}))}setCourseStatusOptions(value){this.coursesStore.update({statusOptions:value})}ngOnDestroy(){}};course_manager_CourseManager=Object(tslib_es6.c)([Object(core.Injectable)(),Object(tslib_es6.f)("design:paramtypes",["function"==typeof(course_manager_a=void 0!==courses_store_CoursesStore&&courses_store_CoursesStore)?course_manager_a:Object,"function"==typeof(_b=void 0!==courses_query_CoursesQuery&&courses_query_CoursesQuery)?_b:Object,"function"==typeof(_c=void 0!==courses_service.a&&courses_service.a)?_c:Object,"function"==typeof(_d=void 0!==dropdown_options_service.a&&dropdown_options_service.a)?_d:Object])],course_manager_CourseManager)},1408:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return DropdownOptionsService}));var _a,tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),_api_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(217);let DropdownOptionsService=class DropdownOptionsService{constructor(apiService){this.apiService=apiService,this.general_sub_url="controller/api",this.misc_sub_url="controller/misc",this.course_components_sub_url="controller/api/courses/components",this.course_batch_components_sub_url="controller/api/batch-components",this.tenant_type_sub_url="controller/api/tenant-type",this.tenant_sub_url="controller/api/tenant",this.config_sub_url="controller/api/config"}currencies(){return this.apiService.get(this.general_sub_url+"/currencies")}courseDeliveryMethods(){return this.apiService.get(this.course_components_sub_url+"/delivery-methods")}courseTypes(){return this.apiService.get(this.course_components_sub_url+"/course-types")}courseSkills(){return this.apiService.get(this.course_components_sub_url+"/skills")}courseLearningLevels(){return this.apiService.get(this.course_components_sub_url+"/learning-levels")}courseInstructorTypes(){return this.apiService.get(this.course_components_sub_url+"/instructor-types")}courseSubjects(){return this.apiService.get(this.course_components_sub_url+"/subjects")}courseInstructionLanguage(){return this.apiService.get(this.course_components_sub_url+"/instruction-language")}courseEnrollmentMethods(){return this.apiService.get(this.course_components_sub_url+"/enrollment-methods")}coursePaymentMethods(){return this.apiService.get(this.course_components_sub_url+"/payment-methods")}courseCompetencies(){return this.apiService.get(this.course_components_sub_url+"/competencies")}courseChannelRequirements(){return this.apiService.get(this.course_components_sub_url+"/channel-requirements")}courseAccessLifetime(){return this.apiService.get(this.course_components_sub_url+"/access-lifetime")}courseSubscriptionTypes(){return this.apiService.get(this.course_components_sub_url+"/subscription-types")}courseAccessTypes(){return this.apiService.get(this.course_components_sub_url+"/access-types")}courseGradeBookDisplaySettings(){return this.apiService.get(this.course_components_sub_url+"/grade-book-display-settings")}courseStatus(){return this.apiService.get(this.course_components_sub_url+"/course-status")}batchStatus(){return this.apiService.get(this.course_batch_components_sub_url+"/batch-status")}batchUserStatus(){return this.apiService.get(this.course_batch_components_sub_url+"/batch-user-status")}tenantTypeRoleTypes(tenantTypeId){return this.apiService.get(`${this.tenant_type_sub_url}/${tenantTypeId}/role-type`)}tenantTypeRolePrivileges(tenantTypeId,typeId){return this.apiService.get(`${this.tenant_type_sub_url}/${tenantTypeId}/privileges/type/${typeId}`)}tenantTypes(){return this.apiService.get(""+this.tenant_type_sub_url)}tenantLanguages(){return this.apiService.get(this.tenant_sub_url+"/languages")}tenantRoleTypes(tenantId){return this.apiService.get(`${this.tenant_sub_url}/${tenantId}/role-type`)}tenantRolePrivileges(tenantId,typeId){return this.apiService.get(`${this.tenant_sub_url}/${tenantId}/privileges/type/${typeId}`)}tenantRoleTemplates(tenantId){return this.apiService.get(`${this.config_sub_url}/${tenantId}/role-template`)}countriesList(){return this.apiService.get(this.misc_sub_url+"/countries")}industriesList(){return this.apiService.get(this.misc_sub_url+"/industries")}organizationRoles(){return this.apiService.get(this.misc_sub_url+"/organization-roles")}};DropdownOptionsService=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.c)([Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__.Injectable)({providedIn:"root"}),Object(tslib__WEBPACK_IMPORTED_MODULE_0__.f)("design:paramtypes",["function"==typeof(_a=void 0!==_api_service__WEBPACK_IMPORTED_MODULE_2__.a&&_api_service__WEBPACK_IMPORTED_MODULE_2__.a)?_a:Object])],DropdownOptionsService)},1412:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return CoursesService}));var _a,tslib__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),_angular_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(0),_api_service__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(217);let CoursesService=class CoursesService{constructor(apiService){this.apiService=apiService,this.course_sub_url="controller/api/courses",this.issuer_sub_url="badgr/api/v1/issuers",this.badges_sub_url="badgr/api/v1/badges",this.pulse_sub_url="controller/api/pulse",this.three_sixty_sub_url="controller/api/three-sixty-degree",this.pathway_sub_url="controller/api/pathways",this.template_sub_url="controller/api/survey"}getCourse(id){return this.apiService.get(`${this.course_sub_url}/${id}`,null,!0)}getCourseList(){return this.apiService.get(this.course_sub_url+"/list-all")}createCourse(data){return this.apiService.post(this.course_sub_url,data)}updateCourse(id,data){return data.id=id,this.apiService.put(""+this.course_sub_url,data)}duplicateCourse(id){return this.apiService.post(`${this.course_sub_url}/duplicate-course/${id}`,null)}courseFileUpload(data){return this.apiService.post(this.course_sub_url+"/file-upload",data)}updateCourseStatus(id,status){return this.apiService.put(`${this.course_sub_url}/${id}/update-status?status=${status}`)}courseIsShortCodeUnique(shortCode){return this.apiService.get(`${this.course_sub_url}/components/is-shortcode-unique?code=${shortCode}`)}getIssuersList(){return this.apiService.get(""+this.issuer_sub_url)}getBadgesForIssuer(issuerId){return this.apiService.get(`${this.issuer_sub_url}/${issuerId}/badges`)}createBadge(issuerId,data){return this.apiService.post(`${this.issuer_sub_url}/${issuerId}/badges`,data)}convertSvgToPng(data){return this.apiService.put("controller/misc/convert-svg-to-png",data,!1)}getPulse(id){return this.apiService.get(`${this.pulse_sub_url}/${id}`)}updatePulse(data){return this.apiService.put(""+this.pulse_sub_url,data)}get360(learningContentId){return this.apiService.get(`${this.three_sixty_sub_url}/learning-content/${learningContentId}`)}update360(data){return this.apiService.put(""+this.three_sixty_sub_url,data)}getPathwayCourseOptions(){return this.apiService.get(this.pathway_sub_url+"/getAll-course-by-tenant")}addCoursesInPathway(data){return this.apiService.post(""+this.pathway_sub_url,data)}updateCoursesInPathway(data){return this.apiService.put(""+this.pathway_sub_url,data)}getPathwayById(pathwayId){return this.apiService.get(`${this.pathway_sub_url}/${pathwayId}`)}deletePathway(pathwayId){return this.apiService.delete(`${this.pathway_sub_url}/${pathwayId}`)}getPathwayPartialProgress(pathwayId){return this.apiService.get(`${this.pathway_sub_url}/partial-progress/pathways/${pathwayId}`)}createPathwayPartialProgress(data){return this.apiService.post(this.pathway_sub_url+"/partial-progress",data)}updatePathwayPartialProgress(data){return this.apiService.put(this.pathway_sub_url+"/partial-progress/",data)}deletePathwayPartialProgress(partialProgressId){return this.apiService.delete(`${this.pathway_sub_url}/partial-progress/${partialProgressId}`)}getSurveyTemplatesForCourse(courseId){return this.apiService.get(`${this.template_sub_url}/course/${courseId}/templates`)}getSelectedSurveyTemplatesForCourse(courseId){return this.apiService.get(`${this.template_sub_url}/course/${courseId}/template`)}updateSurveyTemplateInCourse(data){return this.apiService.put(this.template_sub_url+"/instance",data)}updateCourseContent(courseId){return this.apiService.put(`${this.course_sub_url}/${courseId}/lms/content`,null)}updateCourseCompletionSetting(courseId){return this.apiService.put(`${this.course_sub_url}/${courseId}/lms/completion`,null)}updateCourseGradebook(courseId){return this.apiService.put(`${this.course_sub_url}/${courseId}/lms/gradebook`,null)}};CoursesService=Object(tslib__WEBPACK_IMPORTED_MODULE_0__.c)([Object(_angular_core__WEBPACK_IMPORTED_MODULE_1__.Injectable)({providedIn:"root"}),Object(tslib__WEBPACK_IMPORTED_MODULE_0__.f)("design:paramtypes",["function"==typeof(_a=void 0!==_api_service__WEBPACK_IMPORTED_MODULE_2__.a&&_api_service__WEBPACK_IMPORTED_MODULE_2__.a)?_a:Object])],CoursesService)},1413:function(module,__webpack_exports__,__webpack_require__){"use strict";var DeliveryMethods;__webpack_require__.d(__webpack_exports__,"a",(function(){return DeliveryMethods})),function(DeliveryMethods){DeliveryMethods.OUTSIDE="Outside airskill",DeliveryMethods.INSIDE="Inside airskill"}(DeliveryMethods||(DeliveryMethods={}))}}]);
//# sourceMappingURL=2.8083e24f987c35a716b3.bundle.js.map